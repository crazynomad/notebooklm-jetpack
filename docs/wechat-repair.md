# å¾®ä¿¡å…¬ä¼—å·æ¥æºä¿®å¤ â€” è®¾è®¡æ–‡æ¡£

## é—®é¢˜

å¾®ä¿¡å…¬ä¼—å·æ–‡ç« æ˜¯ä¸­æ–‡äº’è”ç½‘æœ€é‡è¦çš„å†…å®¹è½½ä½“ä¹‹ä¸€ã€‚å½“ç”¨æˆ·åœ¨ NotebookLM ä¸­é€šè¿‡ Fast Research æˆ–æ‰‹åŠ¨æ·»åŠ å¾®ä¿¡é“¾æ¥æ—¶ï¼Œä¼šå‡ºç°ä¸€ç§**å‡æ€§æˆåŠŸ**ç°è±¡ï¼š

- æ¥æºæ˜¾ç¤ºä¸ºå·²å¯¼å…¥ âœ…
- ä½†æ ‡é¢˜æ˜¾ç¤ºçš„æ˜¯ URL è€Œéæ–‡ç« æ ‡é¢˜ï¼ˆå¦‚ `https://mp.weixin.qq.com/s/xxx`ï¼‰
- ç‚¹å¼€æ¥æºï¼Œå†…å®¹æ˜¯å¾®ä¿¡çš„**å®‰å…¨éªŒè¯é¡µé¢**ï¼š"ç¯å¢ƒå¼‚å¸¸ï¼Œå®ŒæˆéªŒè¯åå³å¯ç»§ç»­è®¿é—®"
- NotebookLM ä¼šä¸€æœ¬æ­£ç»åœ°å¯¹è¿™ä¸ªéªŒè¯é¡µé¢åšæ‘˜è¦åˆ†æ

ç”¨æˆ·å¾ˆéš¾å¯Ÿè§‰è¿™ä¸ªé—®é¢˜ï¼Œç›´åˆ°å‘ç° AI çš„å›ç­”å¼•ç”¨äº†"å®‰å…¨æ‹¦æˆªæœºåˆ¶"ç›¸å…³çš„å†…å®¹ã€‚

## ä¸ºä»€ä¹ˆå¾®ä¿¡ç‰¹æ®Š

### å¾®ä¿¡çš„ä¸‰å±‚é˜²æŠ¤

```
ç¬¬ä¸€å±‚ï¼šUser-Agent / Referer æ£€æµ‹
  â†’ éå¾®ä¿¡ç”Ÿæ€çš„è¯·æ±‚ç›´æ¥è¿”å›éªŒè¯é¡µé¢
  â†’ NotebookLM æœåŠ¡ç«¯è¯·æ±‚è¢«æ‹¦æˆª âŒ
  â†’ æµè§ˆå™¨æ‰©å±• SW fetch è¢«æ‹¦æˆª âŒ

ç¬¬äºŒå±‚ï¼šJavaScript åŠ¨æ€æ¸²æŸ“
  â†’ æ–‡ç« å†…å®¹é€šè¿‡ JS æ³¨å…¥åˆ° #js_content
  â†’ çº¯ HTML fetch æ‹¿ä¸åˆ°æ­£æ–‡
  â†’ éœ€è¦å®Œæ•´æµè§ˆå™¨ç¯å¢ƒæ‰§è¡Œ JS âš ï¸

ç¬¬ä¸‰å±‚ï¼šé¢‘ç‡é™åˆ¶ / ç™»å½•æ€
  â†’ çŸ­æ—¶é—´å¤§é‡è¯·æ±‚ä¼šè§¦å‘éªŒè¯ç 
  â†’ éƒ¨åˆ†æ–‡ç« éœ€è¦å¾®ä¿¡ç™»å½•æ‰èƒ½æŸ¥çœ‹
  â†’ æœ€éš¾ç»•è¿‡ ğŸ”’
```

### ä¸ Substack/Medium çš„å…³é”®åŒºåˆ«

| | Substack / Medium | å¾®ä¿¡å…¬ä¼—å· |
|---|---|---|
| fetch èƒ½æ‹¿åˆ°å†…å®¹ï¼Ÿ | âœ… å¤§éƒ¨åˆ†èƒ½ | âŒ è¿”å›éªŒè¯é¡µ |
| éœ€è¦ JS æ¸²æŸ“ï¼Ÿ | âŒ æœåŠ¡ç«¯æ¸²æŸ“ | âœ… å†…å®¹åŠ¨æ€æ³¨å…¥ |
| è§£å†³æ–¹æ¡ˆ | SW fetch + Turndown | æµè§ˆå™¨ tab æ¸²æŸ“ + DOM æå– |

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¾®ä¿¡éœ€è¦**ç‹¬ç«‹çš„ä¿®å¤æµç¨‹**ï¼Œè€Œä¸æ˜¯å¤ç”¨æŠ¢æ•‘ï¼ˆrescueï¼‰çš„ fetch æ–¹æ¡ˆã€‚

## æ£€æµ‹ç­–ç•¥

### å‡æ€§æˆåŠŸçš„è¯†åˆ«

```
æ­£å¸¸æ¥æº: title = "å¦‚ä½•ç”¨ OpenClaw è‡ªåŠ¨åŒ–åŠå…¬"     â†’ æ–‡ç« æ ‡é¢˜
å¾®ä¿¡å‡æº: title = "https://mp.weixin.qq.com/s/xxx" â†’ URL æœ¬èº«
```

å½“ NotebookLM æ— æ³•æå–æ–‡ç« æ ‡é¢˜æ—¶ï¼Œä¼šç”¨ URL ä½œä¸ºæ¥æºåç§°ã€‚å¯¹äºå¾®ä¿¡é“¾æ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯é çš„å‡æ€§æˆåŠŸä¿¡å·ã€‚

**æ£€æµ‹é€»è¾‘ï¼ˆcontent scriptï¼‰ï¼š**

```typescript
function getWechatFakeSuccessSources(): string[] {
  const sources = document.querySelectorAll('.source-title');
  // title ä»¥ https://mp.weixin.qq.com/ å¼€å¤´
  // ä¸”ä¸æ˜¯çº¢è‰²å¤±è´¥æ¥æºï¼ˆé‚£äº›ç”± rescue å¤„ç†ï¼‰
  return sources.filter(s =>
    s.textContent?.startsWith('https://mp.weixin.qq.com') &&
    !s.closest('.single-source-error-container')
  );
}
```

### åçˆ¬å†…å®¹æ£€æµ‹ï¼ˆrescue æµç¨‹çš„é˜²æŠ¤ï¼‰

å³ä½¿é€šè¿‡ rescue çš„ fetch æµç¨‹å¤„ç†å¾®ä¿¡é“¾æ¥ï¼Œä¹Ÿä¼šè¢«æ‹¦æˆªã€‚ä¸ºé˜²æ­¢å‡æ€§æˆåŠŸï¼Œåœ¨ `rescueSources` ä¸­å¢åŠ äº†å†…å®¹è´¨é‡æ£€æµ‹ï¼š

```typescript
// å¾®ä¿¡ç‰¹å¾ï¼šHTML ä¸­æ²¡æœ‰ rich_media_content ä¸” title ä¸ºç©º
if (url.includes('mp.weixin.qq.com')) {
  const hasContent = /rich_media_content|js_content/.test(html);
  const hasTitle = /<title>[^<]{2,}<\/title>/.test(html);
  if (!hasContent && !hasTitle) {
    return 'å¾®ä¿¡å…¬ä¼—å·åçˆ¬æ‹¦æˆªï¼Œéœ€åœ¨å¾®ä¿¡å†…æ‰“å¼€';
  }
}
```

## ä¿®å¤æ–¹æ¡ˆï¼šæµè§ˆå™¨ Tab æ¸²æŸ“

æ—¢ç„¶ fetch ä¸è¡Œï¼Œæˆ‘ä»¬åˆ©ç”¨æµè§ˆå™¨è‡ªèº«çš„æ¸²æŸ“èƒ½åŠ›ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. chrome.tabs.create({ url, active: false })    â”‚
â”‚    åœ¨åå°æ‰“å¼€å¾®ä¿¡é“¾æ¥ï¼ˆç”¨æˆ·ä¸å¯è§ï¼‰                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. ç­‰å¾… onUpdated â†’ status: 'complete'           â”‚
â”‚    + é¢å¤– 3s ç­‰å¾… JS åŠ¨æ€å†…å®¹æ¸²æŸ“                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. chrome.scripting.executeScript()              â”‚
â”‚    åœ¨é¡µé¢ä¸­æå–ï¼š                                   â”‚
â”‚    - #js_content (å¾®ä¿¡æ–‡ç« æ­£æ–‡å®¹å™¨)                  â”‚
â”‚    - .rich_media_title (æ–‡ç« æ ‡é¢˜)                   â”‚
â”‚    - fallback: article, .rich_media_area_primary  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. chrome.tabs.remove() â€” å…³é—­åå° tab            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. å†…å®¹è´¨é‡æ£€æŸ¥ (< 100 å­—ç¬¦ â†’ å¤±è´¥)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 6. importText(content, title)                    â”‚
â”‚    ä»¥"å¤åˆ¶çš„æ–‡å­—"å½¢å¼å¯¼å…¥ NotebookLM               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸ºä»€ä¹ˆæµè§ˆå™¨ Tab èƒ½ç»•è¿‡å¾®ä¿¡é˜²æŠ¤ï¼Ÿ

1. **å®Œæ•´æµè§ˆå™¨ç¯å¢ƒ**ï¼šæœ‰ Cookieã€æœ‰ JS å¼•æ“ã€æœ‰æ­£å¸¸çš„ User-Agent
2. **ç”¨æˆ·çš„æµè§ˆå™¨ä¼šè¯**ï¼šå¦‚æœç”¨æˆ·ä¹‹å‰åœ¨æµè§ˆå™¨ä¸­è®¿é—®è¿‡å¾®ä¿¡æ–‡ç« ï¼Œå¯èƒ½ä¿ç•™äº†æœ‰æ•ˆçš„ session
3. **JavaScript æ‰§è¡Œ**ï¼šå¾®ä¿¡çš„ `#js_content` å†…å®¹æ˜¯ JS åŠ¨æ€æ³¨å…¥çš„ï¼ŒTab ç¯å¢ƒä¸‹ JS æ­£å¸¸æ‰§è¡Œ
4. **éæ´»è·ƒ Tab**ï¼š`active: false` ç¡®ä¿ä¸æ‰“æ‰°ç”¨æˆ·å½“å‰æ“ä½œ

### å±€é™æ€§

- å¦‚æœç”¨æˆ·ä»æœªåœ¨æµè§ˆå™¨ä¸­ç™»å½•è¿‡å¾®ä¿¡ï¼Œéƒ¨åˆ†æ–‡ç« ä»å¯èƒ½éœ€è¦éªŒè¯
- é¢‘ç¹ä¿®å¤å¯èƒ½è§¦å‘å¾®ä¿¡çš„é¢‘ç‡é™åˆ¶
- å¤„ç†é€Ÿåº¦è¾ƒæ…¢ï¼ˆæ¯ä¸ª URL éœ€è¦ ~5-8 ç§’çš„åŠ è½½æ—¶é—´ï¼‰

## ç”¨æˆ·ä½“éªŒ

### åŒå±‚ Banner ç³»ç»Ÿ

```
â”Œâ”€ æ¥æºé¢æ¿ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                          â”‚
â”‚  âš ï¸ 2 ä¸ªæ¥æºå¯¼å…¥å¤±è´¥ï¼Œå¯å°è¯•æŠ¢æ•‘ [â†» æŠ¢æ•‘] â”‚  â† ç¥ç€è‰² Bannerï¼ˆrescueï¼‰
â”‚                                          â”‚
â”‚  ğŸ”§ 2 ä¸ªå¾®ä¿¡å…¬ä¼—å·æ¥æºéœ€è¦ä¿®å¤  [ğŸ”§ ä¿®å¤]  â”‚  â† è“è‰² Bannerï¼ˆrepairï¼‰
â”‚                                          â”‚
â”‚  âœ… Artificial intelligence - Wikipedia   â”‚
â”‚  âœ… OpenClaw - Wikipedia                  â”‚
â”‚  âš ï¸ https://pub.towardsai.net/...        â”‚  â† å¤±è´¥æ¥æº
â”‚  ğŸ“ https://mp.weixin.qq.com/s/...       â”‚  â† å‡æ€§æˆåŠŸ
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¿®å¤å®Œæˆå

```
  ğŸ”§ ä¿®å¤å®Œæˆï¼š2 æˆåŠŸ
    âœ“ å¦‚ä½•ç”¨ OpenClaw è‡ªåŠ¨åŒ–ä½ çš„æ•°å­—ç”Ÿæ´»
    âœ“ AI Agent å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜

  â˜‘ ç§»é™¤åŸå§‹å¾®ä¿¡æ¥æº        [âœ“ å®Œæˆ]
```

ç‚¹å‡»ã€Œå®Œæˆã€åï¼š
1. å¦‚æœå‹¾é€‰äº†ã€Œç§»é™¤åŸå§‹å¾®ä¿¡æ¥æºã€ï¼Œè‡ªåŠ¨é€ä¸ªç‚¹å‡»æ¥æºçš„ã€Œæ›´å¤šã€â†’ã€Œç§»é™¤æ¥æºã€
2. Banner æ¶ˆå¤±
3. æ–°å¯¼å…¥çš„æ–‡æœ¬æ¥æºä¿ç•™ï¼ŒåŒ…å«å®Œæ•´çš„æ–‡ç« å†…å®¹

## ä¸ Rescue çš„å¯¹æ¯”

| ç»´åº¦ | æŠ¢æ•‘ (Rescue) | ä¿®å¤ (Repair) |
|------|--------------|--------------|
| è§¦å‘æ¡ä»¶ | çº¢è‰²å¤±è´¥æ¥æº | å¾®ä¿¡å‡æ€§æˆåŠŸæ¥æº |
| Banner é¢œè‰² | ğŸŸ¡ ç¥ç€è‰² | ğŸ”µ è“è‰² |
| æŠ“å–æ–¹å¼ | Service Worker `fetch()` | æµè§ˆå™¨åå° Tab æ¸²æŸ“ |
| è½¬æ¢æ–¹å¼ | Offscreen Turndown (HTMLâ†’MD) | `executeScript` æå– `innerText` |
| é€Ÿåº¦ | å¿«ï¼ˆ~2-3s/é¡µï¼‰ | æ…¢ï¼ˆ~5-8s/é¡µï¼‰ |
| é€‚ç”¨åœºæ™¯ | Substack, Medium, ä¸€èˆ¬åçˆ¬ | å¾®ä¿¡å…¬ä¼—å·ï¼ˆéœ€è¦ JS æ¸²æŸ“ï¼‰ |
| å®Œæˆåæ“ä½œ | ç§»é™¤å¤±è´¥æ¥æº | ç§»é™¤å‡æ€§æˆåŠŸæ¥æº |

## æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¿®å¤ç›¸å…³ä»£ç  |
|------|-------------|
| `entrypoints/notebooklm.content.ts` | `getWechatFakeSuccessSources()`, `injectRepairBanner()`, `updateRepairBanner()`, `removeSourcesByUrl()` |
| `entrypoints/background.ts` | `repairWechatSources()`, `detectBlockedContent()` |
| `lib/types.ts` | `REPAIR_WECHAT_SOURCES`, `GET_WECHAT_SOURCES` æ¶ˆæ¯ç±»å‹ |

## æœªæ¥å¯èƒ½çš„æ”¹è¿›

1. **é€šç”¨åŒ– Tab æ¸²æŸ“æ–¹æ¡ˆ**ï¼šä¸åªé™äºå¾®ä¿¡ï¼Œä»»ä½•éœ€è¦ JS æ¸²æŸ“çš„é¡µé¢éƒ½å¯ä»¥ç”¨ Tab æ–¹æ¡ˆ
2. **å¾®ä¿¡ç™»å½•æ€æ£€æµ‹**ï¼šåœ¨ä¿®å¤å‰æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆçš„å¾®ä¿¡ cookieï¼Œæç¤ºç”¨æˆ·å…ˆç™»å½•
3. **Markdown è½¬æ¢**ï¼šå½“å‰æå–çš„æ˜¯ `innerText`ï¼ˆçº¯æ–‡æœ¬ï¼‰ï¼Œæœªæ¥å¯ä»¥æ³¨å…¥ Turndown åˆ° Tab ä¸­è·å–æ ¼å¼åŒ–çš„ Markdown
4. **æ‰¹é‡ä¼˜åŒ–**ï¼šå¤ç”¨åŒä¸€ä¸ª Tab ä¾æ¬¡å¯¼èˆªå¤šä¸ª URLï¼Œå‡å°‘ Tab åˆ›å»ºå¼€é”€
